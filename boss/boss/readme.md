Boss直聘每次请求页面都会先重定向到security-check.html并且加载一次加密JS,经过该页面加密(生成设置Cookie)和检测后,会再次跳转重定向到原url的界面.其生成的Cookie中__zp__stoken和acw_tc为两个关键值,acw是访问页面后服务器返回的,而stoken则是在客户端加密后产生的 且stoken的过期时间大概有几个小时,所以这里我为了提升效率使用selenium获取一次Cookie后就直接用requests来请求页面了

全Selenium版本,请求页面后获取浏览器加载解析后的源码并加以解析,更加方便快捷,而且效率损失不大

加密JS的名字大约24小时左右会进行变化,而js文件中的内容也会有所变动,函数本身的加密方式不会进行改变,但是里面加密函数的参数时会发生变化的

由于不是很懂JavaScript加上加密JS做了代码混淆,所以我后续选择了使用Selenium来直接获取Cookie,如果你是一名JS大佬,可以尝试调试分析下

其实一开始也做了使用execjs直接执行js文件来获取zpstoken的尝试,但是js中需要用到浏览器里的window对象,而execjs是使用的nodejs的引擎,并且网上使用npm安装jsdom的方法也没有奏效,这才转向了Selenium

不得不说这个Boss的加密是真的神奇,现在采用的方式是使用Selenium打开页面获取Cookies后将Cookies转交给Requests去请求页面内容,但是有的时候Selenium获取到的Cookie居然不能用,目前猜测应该是Boss的服务端会根据请求内容决定Cookies的过期时间,因为在请求页面的时候会向服务端发送几个没有返回值的get请求,里面会提交当前页面的url以及各项参数等等.并且在GitHub上看其他人的项目也有提到使用加密JS生成出来的zpstoken不能用的情况\

  -----参考：https://github.com/Finalweapons/SpiderForBoss
